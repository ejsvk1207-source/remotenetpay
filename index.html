<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Global Remote Net Salary Calculator</title>
  <meta name="description" content="Simple net salary calculator for remote workers. Estimate your take-home pay after tax." />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    h1 { font-size: 24px; }
    .card { border: 1px solid #ddd; padding: 16px; border-radius: 8px; margin-bottom: 16px; }
    label { display: block; margin-top: 8px; }
    input, select { width: 100%; padding: 8px; margin-top: 4px; }
    button { margin-top: 12px; padding: 10px 16px; cursor: pointer; }
    .result { margin-top: 12px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Global Remote Net Salary Calculator (Simple Beta)</h1>
  <div class="card">
    <label for="country">Country (v0: Germany only)</label>
    <select id="country">
      <option value="de">Germany</option>
    </select>

    <label for="grossSalary">Annual Gross Salary (EUR)</label>
    <input type="number" id="grossSalary" placeholder="e.g. 80000" />

    <label for="employmentType">Employment Type</label>
    <select id="employmentType">
      <option value="employee">Employee</option>
      <option value="freelancer">Freelancer</option>
    </select>

    <button onclick="calculateNet()">Calculate Net Salary</button>

    <div class="result" id="result"></div>
  </div>

<script>
  // 1) URL에서 country 파라미터 읽기
  function getCountryFromQuery() {
    const params = new URLSearchParams(window.location.search);
    const c = params.get('country');
    if (!c) return 'de'; // 기본: 독일
    return c.toLowerCase();
  }

  // 2) 국가 셀렉트 초기화
  function initCountrySelect() {
    var select = document.getElementById('country');
    var qCountry = getCountryFromQuery();

    for (var i = 0; i < select.options.length; i++) {
      if (select.options[i].value.toLowerCase() === qCountry) {
        select.selectedIndex = i;
        break;
      }
    }
  }

  // 3) 세금/사회보장 대략 값 (진짜 세무 아님, 예시용)
  //    나중에 시간 나면 나라별로 조금씩 손봐도 되고,
  //    일단은 "대략적인 시뮬레이션" 느낌으로 가자.
  const taxConfig = {
    de: { taxRate: 0.30, socialRate: 0.20 }, // Germany
    jp: { taxRate: 0.25, socialRate: 0.15 }, // Japan
    uk: { taxRate: 0.28, socialRate: 0.18 }, // United Kingdom
    us: { taxRate: 0.24, socialRate: 0.12 }, // United States (대략)
    ca: { taxRate: 0.26, socialRate: 0.14 }, // Canada
    au: { taxRate: 0.25, socialRate: 0.10 }, // Australia
    fr: { taxRate: 0.28, socialRate: 0.20 }, // France
    es: { taxRate: 0.24, socialRate: 0.18 }, // Spain
    pt: { taxRate: 0.23, socialRate: 0.18 }, // Portugal
    nl: { taxRate: 0.28, socialRate: 0.18 }, // Netherlands
    se: { taxRate: 0.30, socialRate: 0.18 }, // Sweden
    no: { taxRate: 0.30, socialRate: 0.16 }, // Norway
    dk: { taxRate: 0.32, socialRate: 0.16 }, // Denmark
    fi: { taxRate: 0.28, socialRate: 0.18 }, // Finland
    ch: { taxRate: 0.20, socialRate: 0.12 }, // Switzerland
    sg: { taxRate: 0.15, socialRate: 0.10 }, // Singapore
    kr: { taxRate: 0.24, socialRate: 0.09 }, // South Korea
    // 기타: 지정 안 된 코드는 아래 generic으로 처리
  };

  const genericConfig = { taxRate: 0.25, socialRate: 0.15 };

  // 4) 계산 함수
  function calculateNet() {
    var country = document.getElementById('country').value.toLowerCase();
    var gross = parseFloat(document.getElementById('grossSalary').value || 0);
    var type = document.getElementById('employmentType').value;
    var resultDiv = document.getElementById('result');

    if (!gross || gross <= 0) {
      resultDiv.textContent = "Please enter a valid gross salary.";
      return;
    }

    const cfg = taxConfig[country] || genericConfig;

    var taxRate = cfg.taxRate;
    var socialRate = cfg.socialRate;

    // 프리랜서는 사회보장 조금 덜 낸다고 가정
    if (type === 'freelancer') {
      socialRate = socialRate * 0.6;
    }

    var tax = gross * taxRate;
    var social = gross * socialRate;
    var net = gross - tax - social;

    var monthlyNet = net / 12;
    var weeklyNet = net / 52;
    var dailyNet = net / 260; // 근무일 기준 대략
    var effectiveRate = (1 - net / gross) * 100;

    resultDiv.innerHTML = `
      Estimated annual net salary: ${net.toFixed(2)}<br/>
      Monthly net salary: ${monthlyNet.toFixed(2)}<br/>
      Weekly net salary: ${weeklyNet.toFixed(2)}<br/>
      Daily net salary: ${dailyNet.toFixed(2)}<br/>
      Approx. total deduction rate: ${effectiveRate.toFixed(1)}%
    `;
  }

  // 페이지 로드 시 초기화
  window.onload = function() {
    initCountrySelect();
  };
</script>

</body>
</html>
